version: '2'

services:
    mariadb:
        image: docker.io/bitnami/mariadb:10.6
        environment:
            # ALLOW_EMPTY_PASSWORD is recommended only for development.
            - ALLOW_EMPTY_PASSWORD=yes
            - MARIADB_USER=bn_myapp
            - MARIADB_DATABASE=bitnami_myapp
        ports:
            - '${FORWARD_DB_PORT:-3306}:3306'
        volumes:
            - '../mariadb_data:/bitnami/mariadb'
    myapp:
        image: docker.io/bitnami/laravel:9
        ports:
            - '8000:8000'
            - '${VITE_PORT:-5173}:${VITE_PORT:-5173}'
        environment:
            - DB_HOST=mariadb
            - DB_PORT=3306
            - DB_USERNAME=bn_myapp
            - DB_DATABASE=bitnami_myapp
        volumes:
            - '.:/app'
        depends_on:
            - mariadb
